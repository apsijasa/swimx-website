<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Competitions Calendar - Swimx Training</title>
    <meta name="description"
        content="Check out upcoming swimming competitions and register your events to share with the community.">
    <meta name="keywords" content="swimming, competitions, calendar, registration, events">
    <meta name="robots" content="index, follow">
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Aptos:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" href="/analysis/asset/image/favicon.ico" type="image/x-icon">
</head>

<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1>Swimx<span>Training</span></h1>
            </div>
            <!-- Mobile menu toggle button -->
            <button class="menu-toggle" aria-label="Open menu">
                <i class="fas fa-bars"></i>
            </button>
            <nav>
                <ul>
                    <li><a href="index.html">About Us</a></li>
                    <li><a href="index.html">Services</a></li>
                    <li><a href="index.html">Pricing</a></li>
                    <li><a href="videos.html" class="active">Videos</a></li>
                    <li><a href="index.html">Process</a></li>
                    <li><a href="index.html">FAQ</a></li>
                    <li><a href="index.html" class="btn-contacto">Contact</a></li>
                    <li><a href="calendario.html" class="active">Calendar</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero-base hero-calendario">
        <div class="container">
            <div class="hero-content">
                <h2>Competitions Calendar</h2>
                <p>Check out upcoming swimming competitions and register your events to share with the community.</p>
            </div>
        </div>
    </section>

    <section id="registro-competencia" class="registro-competencia">
        <div class="container">
            <h2>Register New Competition</h2>
            <p class="section-description">
                Complete the form below to add your competition to the calendar. Fields marked with * are required.
            </p>

            <form id="competencia-form" class="competencia-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nombre">Competition Name *</label>
                        <input type="text" id="nombre" name="nombre" required>
                    </div>

                    <div class="form-group">
                        <label for="region">Region *</label>
                        <select id="region" name="region" required>
                            <option value="">Select a region</option>
                            <option value="arica">Arica y Parinacota</option>
                            <option value="tarapaca">Tarapacá</option>
                            <option value="antofagasta">Antofagasta</option>
                            <option value="atacama">Atacama</option>
                            <option value="coquimbo">Coquimbo</option>
                            <option value="valparaiso">Valparaíso</option>
                            <option value="metropolitana">Metropolitan Santiago</option>
                            <option value="ohiggins">O'Higgins</option>
                            <option value="maule">Maule</option>
                            <option value="nuble">Ñuble</option>
                            <option value="biobio">Biobío</option>
                            <option value="araucania">La Araucanía</option>
                            <option value="losrios">Los Ríos</option>
                            <option value="loslagos">Los Lagos</option>
                            <option value="aysen">Aysén</option>
                            <option value="magallanes">Magallanes</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="comuna">Commune *</label>
                        <select id="comuna" name="comuna" required>
                            <option value="">Select a commune</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="fecha-inicio">Start Date *</label>
                        <input type="date" id="fecha-inicio" name="fecha-inicio" required>
                    </div>

                    <div class="form-group">
                        <label for="fecha-termino">End Date *</label>
                        <input type="date" id="fecha-termino" name="fecha-termino" required>
                    </div>

                    <div class="form-group">
                        <label for="tipo-piscina">Pool Type *</label>
                        <select id="tipo-piscina" name="tipo-piscina" required>
                            <option value="">Select pool type</option>
                            <option value="25m">25 meters</option>
                            <option value="50m">50 meters</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="email">Organizer's Email *</label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group categorias-group full-width">
                        <label>Competing Categories *</label>
                        <div class="categorias-checkboxes">
                            <div class="check-item">
                                <input type="checkbox" id="categoria-menores" name="categorias" value="Minors">
                                <label for="categoria-menores">Minors</label>
                            </div>
                            <div class="check-item">
                                <input type="checkbox" id="categoria-infantilA" name="categorias" value="Child A">
                                <label for="categoria-infantilA">Child A</label>
                            </div>
                            <div class="check-item">
                                <input type="checkbox" id="categoria-infantilB" name="categorias" value="Child B">
                                <label for="categoria-infantilB">Child B</label>
                            </div>
                            <div class="check-item">
                                <input type="checkbox" id="categoria-juvenilA" name="categorias" value="Youth A">
                                <label for="categoria-juvenilA">Youth A</label>
                            </div>
                            <div class="check-item">
                                <input type="checkbox" id="categoria-juvenilB" name="categorias" value="Youth B">
                                <label for="categoria-juvenilB">Youth B</label>
                            </div>
                            <div class="check-item">
                                <input type="checkbox" id="categoria-tc" name="categorias" value="TC">
                                <label for="categoria-tc">TC</label>
                            </div>
                            <div class="check-item">
                                <input type="checkbox" id="categoria-master" name="categorias" value="Master">
                                <label for="categoria-master">Master</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label for="descripcion">Description *</label>
                        <textarea id="descripcion" name="descripcion" rows="4" required></textarea>
                    </div>
                    <p>*If your event lasts one day, set the end date to the following day.</p>
                    <p>*All events for the day will be published at 11:55 PM.</p>
                    <p>*The tournament organizer will receive a confirmation email once the event is accepted.</p>
                    <p>*All events will be visible in a Google Calendar at the bottom of the page, which you can
                        subscribe to.</p>
                    <p>*For any questions, feel free to contact us using the CONTACT button.</p>
                    <div class="form-group full-width file-group">
                        <label>Rules Document (required) *</label>
                        <div class="file-upload">
                            <input type="file" id="archivo" name="archivo" required>
                            <div class="file-info">
                                <span class="file-name">No file selected</span>
                                <button type="button" class="btn-file">Select file</button>
                            </div>
                        </div>
                        <p class="file-help">Accepted formats: PDF and ZIP.</p>
                    </div>
                </div>

                <div class="form-submit">
                    <button type="submit" class="btn-submit">Register Competition</button>
                </div>

                <div id="form-messages" class="form-messages"></div>
            </form>
        </div>
    </section>

    <section id="calendario-eventos" class="calendario-eventos">
        <div class="container">
            <h2>Upcoming Competitions</h2>
            <!-- Google Calendar widget -->
            <iframe
                src="https://calendar.google.com/calendar/embed?src=YWIzOWY0YmFiMTkzNWY1MGQ5NWE0NTJiNGI0MGQ0ODBjNmExNTVhOTU0YWU2Nzg1OWUxMGNjN2YyMDFjN2ExY0Bncm91cC5jYWxlbmRhci5nb29nbGUuY29t"
                style="border: 0" width="800" height="600" frameborder="0" scrolling="no">
            </iframe>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h3>Swimx<span>Training</span></h3>
                </div>
                <p>&copy; 2025 Swimx Training. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM fully loaded");

            // Region and commune data
            const regionesData = {
                'arica': {
                    comunas: ['Arica', 'Camarones']
                },
                'tarapaca': {
                    comunas: ['Iquique', 'Alto Hospicio', 'Pozo Almonte']
                },
                'antofagasta': {
                    comunas: ['Antofagasta', 'Mejillones', 'Calama']
                },
                'atacama': {
                    comunas: ['Copiapó', 'Caldera', 'Vallenar']
                },
                'coquimbo': {
                    comunas: ['La Serena', 'Coquimbo', 'Ovalle']
                },
                'valparaiso': {
                    comunas: ['Valparaíso', 'Viña del Mar', 'Quilpué', 'San Antonio']
                },
                'metropolitana': {
                    comunas: ['Santiago', 'Providencia', 'Las Condes', 'Maipú', 'Ñuñoa']
                },
                'ohiggins': {
                    comunas: ['Rancagua', 'San Fernando']
                },
                'maule': {
                    comunas: ['Talca', 'Curicó', 'Linares']
                },
                'nuble': {
                    comunas: ['Chillán', 'Chillán Viejo']
                },
                'biobio': {
                    comunas: ['Concepción', 'Talcahuano', 'Los Ángeles']
                },
                'araucania': {
                    comunas: ['Temuco', 'Padre Las Casas']
                },
                'losrios': {
                    comunas: ['Valdivia', 'La Unión']
                },
                'loslagos': {
                    comunas: ['Puerto Montt', 'Osorno', 'Castro']
                },
                'aysen': {
                    comunas: ['Coyhaique', 'Puerto Aysén']
                },
                'magallanes': {
                    comunas: ['Punta Arenas', 'Puerto Natales']
                }
            };

            // DOM Elements
            const regionSelect = document.getElementById('region');
            const comunaSelect = document.getElementById('comuna');
            const fileInput = document.getElementById('archivo');
            const fileInfoName = document.querySelector('.file-name');
            const fileButton = document.querySelector('.btn-file');
            const competenciaForm = document.getElementById('competencia-form');
            const formMessages = document.getElementById('form-messages');

            // Set minimum dates for date inputs
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fecha-inicio').min = today;
            document.getElementById('fecha-termino').min = today;

            // Update end date based on start date
            document.getElementById('fecha-inicio').addEventListener('change', function () {
                document.getElementById('fecha-termino').min = this.value;
                if (document.getElementById('fecha-termino').value && document.getElementById('fecha-termino').value < this.value) {
                    document.getElementById('fecha-termino').value = this.value;
                }
            });

            // Initially disable the commune selector
            comunaSelect.disabled = true;

            // Region selection handler
            regionSelect.addEventListener('change', function () {
                console.log("Selected region:", this.value);

                // Reset commune selector
                comunaSelect.innerHTML = '<option value="">Select a commune</option>';

                // If no region selected, disable commune selector
                if (!this.value) {
                    comunaSelect.disabled = true;
                    return;
                }

                // Enable commune selector
                comunaSelect.disabled = false;

                // Load communes for the selected region
                const comunas = regionesData[this.value].comunas;
                comunas.forEach(comuna => {
                    const option = document.createElement('option');
                    option.value = comuna;
                    option.textContent = comuna;
                    comunaSelect.appendChild(option);
                });
            });

            // File input handler
            fileButton.addEventListener('click', function () {
                fileInput.click();
            });

            fileInput.addEventListener('change', function () {
                if (this.files.length > 0) {
                    fileInfoName.textContent = this.files[0].name;
                } else {
                    fileInfoName.textContent = 'No file selected';
                }
            });

            // Form validation
            function validateForm() {
                // Check for selected categories
                const categoriaValida = document.querySelectorAll('input[name="categorias"]:checked').length > 0;
                if (!categoriaValida) {
                    formMessages.innerHTML = '<div class="alert alert-error">Please select at least one category</div>';
                    return false;
                }

                // Check for selected file
                if (fileInput.files.length === 0) {
                    formMessages.innerHTML = '<div class="alert alert-error">You must upload a rules document</div>';
                    return false;
                }

                return true;
            }

            // Form submission
            competenciaForm.addEventListener('submit', function (e) {
                e.preventDefault();
                console.log("Form submitted");

                // Validate form
                if (!validateForm()) {
                    return;
                }

                // Create FormData for sending
                const formData = new FormData(this);

                // Gather selected categories
                const categorias = [];
                document.querySelectorAll('input[name="categorias"]:checked').forEach(checkbox => {
                    categorias.push(checkbox.value);
                });

                // Replace category checkboxes with an array
                formData.delete('categorias');
                formData.append('categorias', categorias.join(', '));

                // Show loading indicator
                formMessages.innerHTML = '<div class="alert alert-info">Sending data...</div>';

                // Send data to webhook
                fetch('https://hook.us2.make.com/26r1m8d2erwkuofvc8s4hq633l14w4ji', {
                    method: 'POST',
                    body: formData
                })
                    .then(response => {
                        if (response.ok) {
                            return response.text();
                        }
                        throw new Error('Error in server response');
                    })
                    .then(data => {
                        // Show success message
                        formMessages.innerHTML = '<div class="alert alert-success">Competition registered successfully!</div>';
                        competenciaForm.reset();
                        fileInfoName.textContent = 'No file selected';

                        // Reload page after 3 seconds
                        setTimeout(() => {
                            window.location.reload();
                        }, 3000);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        formMessages.innerHTML = '<div class="alert alert-error">Error sending data. Please try again later.</div>';
                    });
            });

            // Mobile menu toggle functionality
            const menuToggle = document.querySelector('.menu-toggle');
            const navUl = document.querySelector('nav ul');

            if (menuToggle && navUl) {
                menuToggle.addEventListener('click', function () {
                    navUl.classList.toggle('active');
                });
            }
        });
    </script>
</body>

</html>